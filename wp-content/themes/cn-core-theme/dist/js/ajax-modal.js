var CN=CN||{};CN.AjaxModal=function(e){this.elements={base:e,modal:$(".js-modal"),modalContent:$(".remodal-content"),allAjaxEl:$('[data-module="ajax-modal"]'),filteredAjaxEl:$('[data-module="ajax-modal"]'),currentEl:""},this.xhr=null,this.thisRemodal=null,this.currentIndex=0,this.init(),this.eventHandlers()},CN.AjaxModal.prototype.init=function(){this.thisRemodal=this.elements.modal.remodal()},CN.AjaxModal.prototype.eventHandlers=function(){var t=this;$(t.elements.base).on("click",function(e){e.preventDefault(),$(document.body).prepend('<div class="c-loading-overlay"><div class="c-loading__container"><div class="c-loading c-loading--white"></div></div></div>'),t.elements.currentEl=$(this),t.elements.filteredAjaxEl=t.elements.allAjaxEl.filter(function(){return!$(this).parent().hasClass("isotope-hidden")}),t.currentIndex=t.elements.filteredAjaxEl.index(t.elements.currentEl),setTimeout(function(){t.thisRemodal.open(),t.updateModalContent(t.elements.base.attr("href"))},100)}),void 0===CN.ajaxModalExists&&(CN.ajaxModalExists=!0,t.elements.modal.on("click",".remodal-prev",function(){t.currentIndex-1<0?t.currentIndex=t.elements.filteredAjaxEl.length-1:t.currentIndex=t.currentIndex-1,t.updateModalContent(t.elements.filteredAjaxEl.eq(t.currentIndex).attr("href"))}),t.elements.modal.on("click",".remodal-next",function(){t.currentIndex+1>=t.elements.filteredAjaxEl.length?t.currentIndex=0:t.currentIndex=t.currentIndex+1,t.updateModalContent(t.elements.filteredAjaxEl.eq(t.currentIndex).attr("href"))}),$(document).on("closed",".js-modal",function(){t.elements.modalContent.html(""),t.xhr&&4!==t.xhr.readyState&&t.xhr.abort()}))},CN.AjaxModal.prototype.updateModalContent=function(e){var l=this;l.xhr&&4!==l.xhr.readyState&&l.xhr.abort(),l.xhr=$.ajax({type:"GET",url:e,success:function(e){var t=e.match(/<style.*?id="siteorigin-panels-grids-wp_head".*?>[\s\S]*?<\/style>/gi),t=(t&&$("head").append(t.join("").replace('id="siteorigin-panels-grids-wp_head"',"")),$(e).filter(".js-ajax-assets")),n=$(e).find(".s-page-wrap");n&&l.elements.modal.attr("data-content-post-type",(e=n).attr("data-post-type")),l.elements.modalContent.html(e),t.each(function(){var e=JSON.parse($(this).text());l.getMultipleScripts(e.scripts.map(function(e){if(0===$('script[src="'+e.url+'"]').length)return e.url})),$.each(e.stylesheets,function(e,t){0===$('link[href="'+t.url+'"]').length&&$("head").append('<link rel="stylesheet" href="'+t.url+'">')})}),l.reinitJS(),setTimeout(function(){$("body").trigger("ajaxModalHasLoaded"),$(window).trigger("resize"),$(".c-loading-overlay").remove()},100)},error:function(e){setTimeout(function(){$(".c-loading-overlay").remove()},100)}})},CN.AjaxModal.prototype.reinitJS=function(){var e=this;$(document).trigger("cnInitSliders",{element:e.elements.modalContent}),$(document).trigger("cnInitWidgetWaypoints",{element:e.elements.modalContent}),$(document).trigger("cnInitAnchorMenu",{element:e.elements.modalContent}),CN.InitModules({element:e.elements.modalContent}),$(document).trigger("cnInitGallery",{element:e.elements.modalContent}),$(document).trigger("cnInitMap",{element:e.elements.modalContent}),$(document).trigger("cnInitBookingFormWidget",{element:e.elements.modalContent})},CN.AjaxModal.prototype.getMultipleScripts=function(e,t){var n,l;void 0!==e[t=t||0]&&(n=this,(l=document.createElement("script")).onload=function(){t++,e.length>t&&n.getMultipleScripts(e,t)},l.src=e[t],document.getElementsByTagName("head")[0].appendChild(l))};